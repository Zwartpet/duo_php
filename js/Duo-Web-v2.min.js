window.Duo=function(a,b){function n(a,b){throw new Error("Duo Web SDK error: "+a+(b?"\nSee "+b+" for more information":""))}function o(a){return a.replace(/([a-z])([A-Z])/,"$1-$2").toLowerCase()}function p(a,b){return"dataset"in a?a.dataset[b]:a.getAttribute("data-"+o(b))}function q(a,c,d,e){"addEventListener"in b?a.addEventListener(c,e,!1):a.attachEvent(d,e)}function r(a,c,d,e){"removeEventListener"in b?a.removeEventListener(c,e,!1):a.detachEvent(d,e)}function s(b){q(a,"DOMContentLoaded","onreadystatechange",b)}function t(b){r(a,"DOMContentLoaded","onreadystatechange",b)}function u(a){q(b,"message","onmessage",a)}function v(a){r(b,"message","onmessage",a)}function w(a){if(a){0===a.indexOf("ERR|")&&n(a.split("|")[1]),a.indexOf(":")!==-1&&2===a.split(":").length||n("Duo was given a bad token.  This might indicate a configuration problem with one of Duo's client libraries.","https://www.duosecurity.com/docs/duoweb#first-steps");var b=a.split(":");return i=a,j=b[0],k=b[1],{sigRequest:a,duoSig:b[0],appSig:b[1]}}}function x(){if(l=a.getElementById(e),!l)throw new Error('This page does not contain an iframe for Duo to use.Add an element like <iframe id="duo_iframe"></iframe> to this page.  See https://www.duosecurity.com/docs/duoweb#3.-show-the-iframe for more information.');B(),t(x)}function y(a){return Boolean(a.origin==="https://"+h&&"string"==typeof a.data&&(a.data.match(c)||a.data.match(d)))}function z(b){b&&(b.host&&(h=b.host),b.sig_request&&w(b.sig_request),b.post_action&&(f=b.post_action),b.post_argument&&(g=b.post_argument),b.iframe&&("string"==typeof b.iframe?e=b.iframe:"tagName"in b.iframe&&(l=b.iframe)),"function"==typeof b.submit_callback&&(m=b.submit_callback)),l?B():(l=a.getElementById(e),l?B():s(x)),t(z)}function A(a){y(a)&&(C(a.data),v(A))}function B(){h||(h=p(l,"host"),h||n("No API hostname is given for Duo to use.  Be sure to pass a `host` parameter to Duo.init, or through the `data-host` attribute on the iframe element.","https://www.duosecurity.com/docs/duoweb#3.-show-the-iframe")),j&&k||(w(p(l,"sigRequest")),j&&k||n("No valid signed request is given.  Be sure to give the `sig_request` parameter to Duo.init, or use the `data-sig-request` attribute on the iframe element.","https://www.duosecurity.com/docs/duoweb#3.-show-the-iframe")),""===f&&(f=p(l,"postAction")||f),"sig_response"===g&&(g=p(l,"postArgument")||g),l.src=["https://",h,"/frame/web/v1/auth?tx=",j,"&parent=",encodeURIComponent(a.location.href),"&v=2.3"].join(""),u(A)}function C(b){var c=a.createElement("input");c.type="hidden",c.name=g,c.value=b+":"+k;var d=a.getElementById("duo_form");d||(d=a.createElement("form"),l.parentElement.insertBefore(d,l.nextSibling)),d.method="POST",d.action=f,d.appendChild(c),"function"==typeof m?m.call(null,d):d.submit()}var h,i,j,k,l,m,c=/^(?:AUTH|ENROLL)+\|[A-Za-z0-9\+\/=]+\|[A-Za-z0-9\+\/=]+$/,d=/^ERR\|[\w\s\.\(\)]+$/,e="duo_iframe",f="",g="sig_response";return s(z),{init:z,_parseSigRequest:w,_isDuoMessage:y,_doPostBack:C}}(document,window);